<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <link rel="icon" type="image/x-icon" href="../image/DiscInLogo.png"/>
    <meta name="author" content="Ophelie Gavillet" content="Ugo Bismara"/>
    <meta name="description" content="This year‚Äôs edition is unlike any other‚Äîwhile we welcome everyone, we are prioritizing young participants to grow the next generation of ultimate players! We want everyone to be part of this incredible adventure, but this festival is especially designed to empower younger players and give them a platform to shine. Get ready for an unforgettable week of ultimate frisbee, music, creativity, and most importantly, community! The festival will take place in the beautiful setting of Saint-Martin-en-Haut, France üìç, from July 14th to July 19th, 2025 üìÜ."/>
    <meta name="keywords" content="ultimate frisbee, frisbee community, disc sport, ultimate team, frisbee family, competitive frisbee, team spirit, sports community, ultimate, frisbee, community, disc, sport, collective, family, camp, festival"/>
    <title>Disc In Camp | Players</title>
    <!-- Firebase SDK pour le navigateur -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="../style/participants.css">
    <link rel="stylesheet" href="../style/style.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Blinker:wght@100;200;300;400;600;700;800;900&family=Gabarito:wght@400..900&display=swap" rel="stylesheet">
  </head>
  <body>
    <!--Header-->
    <section class="header">
        <a href="login.html" class="login-button">
            <p class="log-option">Login</p>
            <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-person-circle" viewBox="0 0 16 16">
            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
            </svg>
        </a>
        <a class="logo" href="../index.html">
            <img src="../image/DiscInLogo.png" alt="Logo" />
        </a>
    </section>

    <!--Main-->
    <main>
    <div id="participant-info"></div>
    
    <h4 class="mg-btm">SCHEDULE</h4>
    <div class="carousel-wrapper">
      <div class="carousel">
        <div class="carousel-inner"></div>

        <div class="nav-buttons">
          <button id="prev">&#8249;</button>
          <button id="next">&#8250;</button>
        </div>
      </div>
      <div class="dots"></div>
    </div>

    <div class="badge-section">
      <h4>DISC IN BADGES</h4>
      <div id="participant-badges"></div>
    </div>
    
    <h4>ACTIONS</h4>
    <div id="participant-buttons"></div>

    <div id="modal" class="modal">
      <span class="close" id="closeModal">&times;</span>
      <img id="modalImage" alt="Participant Image" />
    </div>

    <div id="crushPopup" class="popup">
      ‚ù§Ô∏è <span>SOMEONE IS CRUSHING ON YOU</span> ‚ù§Ô∏è
    </div>

    </main>
     <!--Footer-->
      <div class="navbar">
      <a href="../index.html" class="navbar-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="8vw" height="8vw" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
          <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
          </svg>
          HOME
      </a>
      <a href="players.html" class="navbar-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="8vw" height="8vw" fill="currentColor" class="bi bi-people" viewBox="0 0 16 16">
          <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"/>
          </svg>
          PLAYERS
      </a>
      <a href="schedule.html" class="navbar-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="8vw" height="8vw" fill="currentColor" class="bi bi-calendar" viewBox="0 0 16 16">
          <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
          </svg>
          SCHEDULE
      </a>
      <a href="feedback.html" class="navbar-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="8vw" height="8vw" fill="currentColor" class="bi bi-chat-square-text" viewBox="0 0 16 16">
          <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-2.5a2 2 0 0 0-1.6.8L8 14.333 6.1 11.8a2 2 0 0 0-1.6-.8H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a1 1 0 0 1 .8.4l1.9 2.533a1 1 0 0 0 1.6 0l1.9-2.533a1 1 0 0 1 .8-.4H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
          <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"/>
        </svg>
        FEEDBACK
      </a>
      <a href="news.html" class="navbar-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="8vw" height="8vw" fill="currentColor" class="bi bi-newspaper" viewBox="0 0 16 16">
          <path d="M0 2.5A1.5 1.5 0 0 1 1.5 1h11A1.5 1.5 0 0 1 14 2.5v10.528c0 .3-.05.654-.238.972h.738a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 1 1 0v9a1.5 1.5 0 0 1-1.5 1.5H1.497A1.497 1.497 0 0 1 0 13.5zM12 14c.37 0 .654-.211.853-.441.092-.106.147-.279.147-.531V2.5a.5.5 0 0 0-.5-.5h-11a.5.5 0 0 0-.5.5v11c0 .278.223.5.497.5z"/>
          <path d="M2 3h10v2H2zm0 3h4v3H2zm0 4h4v1H2zm0 2h4v1H2zm5-6h2v1H7zm3 0h2v1h-2zM7 8h2v1H7zm3 0h2v1h-2zm-3 2h2v1H7zm3 0h2v1h-2zm-3 2h2v1H7zm3 0h2v1h-2z"/>
          </svg>
          NEWS
      </a>
      </div>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCiy-xiOoMMgr4rwBKwGQRsA9fleX1_wT8",
        authDomain: "disc-in-camp.firebaseapp.com",
        databaseURL:
          "https://disc-in-camp-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "disc-in-camp",
        storageBucket: "disc-in-camp.appspot.com",
        messagingSenderId: "128937547779",
        appId: "1:128937547779:web:22677cb4478cffaf1a1636",
        measurementId: "G-Y4KZY16LFF",
      };

      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
      const participantId = sessionStorage.getItem("participantId") - 1;
      const participantInfoDiv = document.getElementById("participant-info");
      const mondayInfoDiv = document.getElementById("monday-info");
      const tuesdayInfoDiv = document.getElementById("tuesday-info");
      const wednesdayInfoDiv = document.getElementById("wednesday-info");
      const thursdayInfoDiv = document.getElementById("thursday-info");
      const fridayInfoDiv = document.getElementById("friday-info");
      const participantBadgesDiv = document.getElementById("participant-badges");
      const participantButtonsDiv = document.getElementById("participant-buttons");
      const modal = document.getElementById("modal");
      const modalImage = document.getElementById("modalImage");
      const closeModal = document.getElementById("closeModal");
      const carouselInner = document.querySelector(".carousel-inner");
      const dotsContainer = document.querySelector(".dots");

      const daysOfWeek = [
        "MONDAY",
        "TUESDAY",
        "WEDNESDAY",
        "THURSDAY",
        "FRIDAY",
      ];

      function createSessionHTML(dayData, day) {
        const sessions = [
          {
            time: dayData[`${day.toLowerCase()}TrainingTime`],
            field: `Field ${
              dayData[`${day.toLowerCase()}TrainingField`] || "N/A"
            }`,
            coach: dayData[`${day.toLowerCase()}TrainingCoach`] || "N/A",
            type: "Training",
          },
          {
            time: dayData[`${day.toLowerCase()}GameTime`],
            field: `Field ${dayData[`${day.toLowerCase()}GameField`] || "N/A"}`,
            coach: dayData[`${day.toLowerCase()}GameCoach`] || "N/A",
            type: "Game",
          },
          {
            time: dayData[`${day.toLowerCase()}PresentationTime`],
            field: dayData[`${day.toLowerCase()}PresentationPlace`] || "N/A",
            coach: dayData[`${day.toLowerCase()}PresentationCoach`] || "N/A",
            type: "Presentation",
          },
        ];

        const sortedSessions = sessions.sort((a, b) => {
          // Comparer les heures (time) pour trier
          if (a.time < b.time) return -1;
          if (a.time > b.time) return 1;
          return 0; // Si √©galit√©
        });

        return sortedSessions
          .map(
            (session) => `
        <div class="session-wrapper">
            <div class="session-item">
              <div class="session-type">
                <span>${session.type}</span>
              </div>
              <div class="session-info">
                <span class="time">${session.time || "N/A"}</span>
                <span class="coach">${session.coach}</span>
                <span class="field">${session.field}</span>
              </div>
            </div>
        </div>`
          )
          .join("");
      }

      function fetchDayData(day) {
        database.ref(`/players/${participantId}`).on("value", (snapshot) => {
          const dayData = snapshot.val();
          if (dayData) {
            const dayElement = document.createElement("div");
            dayElement.className = "carousel-item";
            dayElement.innerHTML = `
                <h5>${day}</h5>
                ${createSessionHTML(dayData, day)}
            `;
            carouselInner.appendChild(dayElement);

            const dot = document.createElement("span");
            dot.className = "dot";
            dotsContainer.appendChild(dot);
            updateCarousel();
          }
        });
      }

      // Fetch and display data for all days
      daysOfWeek.forEach(fetchDayData);

      // Carousel navigation
      let index = 0;

      function updateCarousel() {
        const items = document.querySelectorAll(".carousel-item");
        const dots = document.querySelectorAll(".dot");
        carouselInner.style.transform = `translateX(-${index * 100}%)`;

        dots.forEach((dot, i) => dot.classList.toggle("active", i === index));
      }

      document.getElementById("prev").addEventListener("click", () => {
        index =
          index > 0
            ? index - 1
            : document.querySelectorAll(".carousel-item").length - 1;
        updateCarousel();
      });

      document.getElementById("next").addEventListener("click", () => {
        index =
          index < document.querySelectorAll(".carousel-item").length - 1
            ? index + 1
            : 0;
        updateCarousel();
      });

      // Variables globales
      let startX = 0;
      let currentX = 0;
      let isSwiping = false;

      // Fonction pour r√©initialiser le swipe
      function resetSwipe() {
        startX = 0;
        currentX = 0;
        isSwiping = false;
      }

      // D√©tection du d√©but du swipe
      carouselInner.addEventListener("touchstart", (e) => {
        startX = e.touches[0].clientX;
        isSwiping = true;

        // D√©sactiver la transition pour un d√©placement fluide
        carouselInner.style.transition = "none";
      });

      // Gestion du mouvement du swipe
      carouselInner.addEventListener("touchmove", (e) => {
        if (!isSwiping) return;

        currentX = e.touches[0].clientX;
        const diffX = currentX - startX;

        // D√©placement temporaire de l'√©l√©ment
        const offset = -index * carouselInner.offsetWidth + diffX;
        carouselInner.style.transform = `translateX(${offset}px)`;
      });

      // Gestion de la fin du swipe
      carouselInner.addEventListener("touchend", () => {
        if (!isSwiping) return;

        const diffX = currentX - startX;
        const threshold = 50; // Seuil de d√©placement minimum pour valider un swipe

        // D√©terminer la direction du swipe
        if (Math.abs(diffX) > threshold) {
          if (diffX > 0) {
            // Swipe vers la droite
            index =
              index > 0
                ? index - 1
                : document.querySelectorAll(".carousel-item").length - 1;
          } else {
            // Swipe vers la gauche
            index =
              index < document.querySelectorAll(".carousel-item").length - 1
                ? index + 1
                : 0;
          }
        }

        // R√©initialisation de la position avec une transition fluide
        carouselInner.style.transition = "transform 0.5s ease";
        updateCarousel();

        // R√©initialisation des variables
        resetSwipe();
      });

      // Mise √† jour initiale du carrousel
      updateCarousel();

      closeModal.onclick = () => {
        modal.style.display = "none";
      };

      window.onclick = (event) => {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };

      function getTeamOverlay(team) {
        const validTeams = ["green", "red", "blue", "yellow"];
    if (!team || !validTeams.includes(team.toLowerCase())) {
        return "../filters/grey.png"; // Si l'√©quipe n'est pas reconnue, filtre gris
    }
        return `../filters/${team.toLowerCase()}.png`; // Chemin de l'image d'overlay
}

      function showCrushPopup() {
        const popup = document.getElementById("crushPopup");
        popup.style.display = "block";

        // Masquer le pop-up apr√®s 4 secondes
        setTimeout(() => {
          popup.style.display = "none";
        }, 2500);
      }

      database.ref(`/players/${participantId}`).on("value", (snapshot) => {
        const data = snapshot.val();
        if (data && data.Crush && data.Crush.trim() !== "") {
          showCrushPopup();
        }
        if (data) {
          const roundedMoney = parseFloat(data.Money).toFixed(2); // Arrondi au centi√®me
          participantInfoDiv.innerHTML = `
  <div class="info-container">
      <h1>${data.Name}</h1>
      <div class="container">
        <div class="photo-container">
            <img src="${data.Picture}" alt="Photo of ${data.Name}" id="participantPhoto">
            <div class="background-overlay" style="background-image: url('${getTeamOverlay(data.Team)}');" id="participantFiltre"></div>
            <div class="name-overlay">${data.Crush ? "‚ù§Ô∏è" : ""}</div>
        </div>
        <div class="data-container">
          <h4 class="mg-btm">INFORMATIONS</h4>
          <p><b>AGE:</b> ${data.Age} years old</p>
          <p><b>COUNTRY:</b> ${data.Nationality}</p>
          <p><b>ROLE:</b> ${data.Position}</p>
          <p><b>ULTIMATE YEARS:</b> ${data.UltimateXP}</p>
          <p><b>TEAM:</b> ${data.Team}</p>
        </div>
      </div>
  </div>`;

          const participantPhoto = document.getElementById("participantFiltre");
          participantPhoto.onclick = () => {
            modal.style.display = "flex";
            modalImage.src = data.Picture;
          };
        } else {
          participantInfoDiv.innerHTML = "<p>Participant not found!</p>";
        }
      })

      database.ref(`/players/${participantId}`).on("value", (snapshot) => {
        const data = snapshot.val();
      if (data) {
          participantBadgesDiv.innerHTML= `
    <div class="badge-grid">
      <div class="badge">
        <img src="../image/nombres.png" width="40px"/>
        <h5 class="orange">EDITIONS</h5>
        <p>${data.Editions}</p>
      </div>
      <div class="badge">
        <img src="../image/interet-commun.png" width="40px"/>
        <h5 class="orange">ACTIVITIES</h5>
        <p>${data.Activities}</p
      </div></div>
      <div class="badge">
        <img src="../image/rapport-dactivite.png" width="40px"/>
        <h5 class="orange">ROLE</h5>
        <p>${data.Role}</p
      </div>
    </div> `;
} else {
          participantBadgesDiv.innerHTML = "<p>Participant not found!</p>";
        }
      })

        database.ref(`/players/${participantId}`).on("value", (snapshot) => {
          const data = snapshot.val();
        if (data) {
          participantButtonsDiv.innerHTML= `
    <div class="buttons-grid">
      <div class=button">
        <a href="https://api.whatsapp.com/send/?phone=${data.Phone}&text&type=phone_number&app_absent=0">
          <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="#e78052" class="bi bi-whatsapp" viewBox="0 0 16 16">
            <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.73.73 0 0 0-.529.247c-.182.198-.691.677-.691 1.654s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"/>
          </svg>
        </a>
      </div>
      <div class=button">
         <button style="--i:#D2602C;--j:#E78052;">
            <span class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
  <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"></path>
</svg>
            </span>
            <span class="title">Super Crush</span>
        </button>
      </div>
    </div> `;
        } else {
          participantButtonsDiv.innerHTML = "<p>Participant not found!</p>";
        }
      })

    </script>
  </body>
</html>
