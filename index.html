<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DISC IN CAMP 2025</title>
    <!-- Firebase SDK pour le navigateur -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <h1>DISC IN CAMP 2025</h1>
    <div class="top-bar">
      <button onclick="goToHome()" class="home-button">üè† Home</button>
  </div>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Camper name">
    </div>
    <div class="filter-bar">
        <button onclick="applyFilters('all')" class="filter-button">All</button>
        <button onclick="applyFilters('green')" class="filter-button" style="background-color: #8fbc8f;">Green</button>
        <button onclick="applyFilters('red')" class="filter-button" style="background-color: #f08080;">Red</button>
        <button onclick="applyFilters('blue')" class="filter-button" style="background-color: #add8e6;">Blue</button>
        <button onclick="applyFilters('yellow')" class="filter-button" style="background-color: #fffacd;">Yellow</button>
    </div>
    <div id="data" class="participants-grid"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCiy-xiOoMMgr4rwBKwGQRsA9fleX1_wT8",
            authDomain: "disc-in-camp.firebaseapp.com",
            databaseURL: "https://disc-in-camp-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "disc-in-camp",
            storageBucket: "disc-in-camp.appspot.com",
            messagingSenderId: "128937547779",
            appId: "1:128937547779:web:22677cb4478cffaf1a1636",
            measurementId: "G-Y4KZY16LFF"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        let cachedData = [];
        const dataContainer = document.getElementById("data");

        function getTeamColor(team) {
            const colors = {
                Green: '#8fbc8f',
                Red: '#f08080',
                Blue: '#add8e6',
                Yellow: '#fffacd'
            };
            return colors[team] || '#ffffff';
        }

        function createCamperCard({ Id, Name, Picture, Team }) {
            const card = document.createElement('a');
            card.className = 'participant';
            card.style.backgroundColor = getTeamColor(Team);
            card.dataset.color = Team;

            const img = document.createElement('img');
            img.src = Picture;
            img.alt = `${Name}'s photo`;
            img.className = 'participant-photo';

            const nameElement = document.createElement('h2');
            nameElement.innerText = Name;

            card.addEventListener('click', () => {
                sessionStorage.setItem('participantId', Id);
                window.location.href = 'participants.html';
            });

            card.appendChild(img);
            card.appendChild(nameElement);
            return card;
        }

        function updateUI(filteredData) {
            // Clear existing data
            dataContainer.innerHTML = '';

            const fragment = document.createDocumentFragment();
            filteredData.forEach(camper => {
                const card = createCamperCard(camper);
                fragment.appendChild(card);
            });

            dataContainer.appendChild(fragment);
        }

        function applyFilters(color = 'all') {
            const searchValue = document.getElementById('searchInput').value.toLowerCase();

            const filteredData = cachedData.filter(camper => {
                const matchesColor = color === 'all' || camper.Team.toLowerCase() === color.toLowerCase();
                const matchesSearch = camper.Name.toLowerCase().includes(searchValue);
                return matchesColor && matchesSearch;
            });

            updateUI(filteredData);
        }

        function fetchData() {
            const refPlayers = database.ref('/players');
            refPlayers.once('value', snapshot => {
                const data = snapshot.val();
                cachedData = Object.keys(data).map(key => data[key]); // Cache data
                updateUI(cachedData); // Initial render
            }, error => {
                console.error('Erreur de r√©cup√©ration :', error);
            });
        }

        // Attach search event
        document.getElementById('searchInput').addEventListener('input', () => applyFilters());

        // Fetch data on load
        fetchData();

        function goToHome() {
        window.location.href = 'home.html'; // Remplacez 'index.html' par l'URL exacte de votre page d'accueil si n√©cessaire
    }
    </script>
</body>
</html>
