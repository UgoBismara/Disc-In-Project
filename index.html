<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DISC IN CAMP 2025</title>
    <!-- Firebase SDK pour le navigateur -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
     <!-- Fichier CSS externe -->
     <link rel="stylesheet" href="index.css">
 
</head>
<body>
    <h1>DISC IN CAMP 2025</h1>
    <div class="search-bar">
      <input type="text" id="searchInput" onkeyup="fetchData('all')" placeholder="Camper name">
    </div>
    <div class="filter-bar">
      <button onclick="filterByColor('all')" class="filter-button" aria-label="Show all participants">All</button>
      <button onclick="filterByColor('green')" class="filter-button" style="background-color: #8fbc8f;" aria-label="Show green participants">Green</button>
      <button onclick="filterByColor('red')" class="filter-button" style="background-color: #f08080;" aria-label="Show red participants">Red</button>
      <button onclick="filterByColor('blue')" class="filter-button" style="background-color: #add8e6;" aria-label="Show blue participants">Blue</button>
      <button onclick="filterByColor('yellow')" class="filter-button" style="background-color: #fffacd;" aria-label="Show yellow participants">Yellow</button>
    </div>
    <div id="data" class="participants-grid">
        <!-- Les cartes des campeurs s'afficheront ici -->
    </div>

    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCiy-xiOoMMgr4rwBKwGQRsA9fleX1_wT8",
            authDomain: "disc-in-camp.firebaseapp.com",
            databaseURL: "https://disc-in-camp-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "disc-in-camp",
            storageBucket: "disc-in-camp.appspot.com",
            messagingSenderId: "128937547779",
            appId: "1:128937547779:web:22677cb4478cffaf1a1636",
            measurementId: "G-Y4KZY16LFF"
        };

        function getTeamColor(team) {
        switch (team) {
        case 'Green':
          return '#8fbc8f'; // Softened green
        case 'Red':
          return '#f08080'; // Softened red
        case 'Blue':
          return '#add8e6'; // Softened blue
        case 'Yellow':
          return '#fffacd'; // Softened yellow
        default:
          return '#ffffff'; // Default to white if no match
      }
    }

        // Initialisation de Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Récupération des données
        const dataContainer = document.getElementById("data");
        dataContainer.innerHTML = '';
        const refPlayers = database.ref("/players");
        const refMonday = database.ref("/monday");

        function createCamperCard(id, name, photoUrl, team) {
        let participantDiv = document.createElement('a');
        // participantDiv.href = `https://script.google.com/macros/s/AKfycbx4Yi98ujFs8Smabm6_ruEDPURJcKhYnOTXgn1mw2I/dev?page=Participants&id=${id}`;
        participantDiv.classList.add('participant');
        participantDiv.dataset.color = team;
        participantDiv.style.backgroundColor = getTeamColor(team);

        const img = document.createElement('img');
        img.src = photoUrl; // URL de l'image
        img.className = 'participant-photo'; // Ajouter la classe pour le style

        // Créer un élément pour le nom du participant
        const nom = document.createElement('h2');
        nom.innerText = name; // Nom du participant

        participantDiv.addEventListener('click', () => {
        selectParticipant(id);
        })

        participantDiv.appendChild(img);
        participantDiv.appendChild(nom);
        dataContainer.appendChild(participantDiv);

        }

        function selectParticipant(participantId) {
    // Stocker l'ID dans localStorage
    sessionStorage.setItem('participantId', participantId);

    // Rediriger vers la page des participants
    window.location.href = 'participants.html';
}


        function fetchData(color) {
    let input = document.getElementById('searchInput').value.toLowerCase();
    refPlayers.on("value", (snapshot) => {
        const data = snapshot.val();
        dataContainer.innerHTML = ""; // Clear the container
        
        for (const key in data) {
            const camper = data[key];
            const camperNameLower = camper.Name ? camper.Name.toLowerCase() : '';
            const camperTeamLower = camper.Team ? camper.Team.toLowerCase() : '';

            // Combine the filters: color (team) and input (name search)
            const matchesColor = (camperTeamLower !== '' && (color.toLowerCase() === camperTeamLower || color.toLowerCase() === 'all'));
            const matchesInput = camperNameLower.includes(input);

            if (matchesColor && matchesInput) {
                createCamperCard(camper.Id, camper.Name, camper.Picture, camper.Team);
            }
        }
    }, (error) => {
        console.error("Erreur de récupération :", error);
    });
}

function filterByColor(color) {
        fetchData(color);
    }

        // Appel pour charger les données
        fetchData("all");
    </script>
</body>
</html>
